<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Data Visualization</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!--link rel="stylesheet" href="font.css"-->
    <style media="screen">
      @import url(https://cdn.jsdelivr.net/gh/moonspam/NanumSquare@1.0/nanumsquare.css);
      html,body {font-family:NanumSquare !important;}
    </style>
    <style media="screen">
      button{
      background:#1AAB8A;
      color:#fff;
      border:none;
      position:relative;
      height:30px;
      font-size:1em;
      padding:0 2em;
      cursor:pointer;
      transition:800ms ease all;
      outline:none;
      }
      button:hover{
      background:#fff;
      color:#1AAB8A;
      }
      button:before,button:after{
      content:'';
      position:absolute;
      top:0;
      right:0;
      height:2px;
      width:0;
      background: #1AAB8A;
      transition:400ms ease all;
      }
      button:after{
      right:inherit;
      top:inherit;
      left:0;
      bottom:0;
      }
      button:hover:before,button:hover:after{
      width:100%;
      transition:800ms ease all;
      }
    </style>

  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col">
          <h1 style = 'margin-top:50px; margin-bottom:10px; text-align:left; font-size:xx-large;font-weight: bold;font-family:'>
            코로나 확진자 수 예측 by Kalman Filter
          </h1>
        </div>
      </div>
      <p style = " font-size:0.75em;  color: gray;">
        최종 업로드 시간 | 2020-06-25 15:00 | 고주희, 박주은, 이자은, 이건희
      </p>
      <hr>
      <p style = " font-size:0.75em;  color: gray;text-align:justify;">
        * 이 웹 페이지는 연세대학교 디자인 인텔리전스 데이터 시각화 수업 과제의 일환으로 추가적인 배포나 무단 공유를 금지한다. *
      <br>** 프로젝트에 사용된 다양한 코드는 코드 보기 페이지에서 상세하게 표기해 두었습니다 **
      </p>
      <button type="button" onclick="location.href='prj02.html'">1. 코로나 예측</button>
      <button type="button" onclick="location.href='prj02_korea.html'">2. 국내 경제</button>
      <button type="button" onclick="location.href='prj02_foreign.html'">3. 국제 경제</button>
      <button type="button" onclick="location.href='prj02_code.html'">4. 코드 보기</button>
      <p style = "margin-top: 20px; font-size:1.25em; color:	#000080; font-weight:bolder">
        | R 코드를 활용한 칼만 필터와 구글 코랩을 사용하여 코로나 확진자 수 예상하기
      </p >
      <div class="row">
        <div class="col">
          <p style="text-align:justify">
            Ran Kremer이 Kalman Filter로 제작한 모델은 그동안 단기간의 확진자 증가 수를 비교적 정확하게 예측했습니다. 이 프로젝트에서는 Ran Kremer의 모델을 대한민국의 경우에 한정해서 확진자 수의 경향을 예측해보려고 합니다.
          </p>
          <p style = " font-size:0.75em;  color: gray;text-align:justify;">
            * 안정적인 실험 환경을 위해 Google colab과 Google Drive에서 실행 합니다.
          </p>
          <div class="colorscripter-code" style="color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div><div style="line-height:130%">36</div><div style="line-height:130%">37</div><div style="line-height:130%">38</div><div style="line-height:130%">39</div><div style="line-height:130%">40</div><div style="line-height:130%">41</div><div style="line-height:130%">42</div><div style="line-height:130%">43</div><div style="line-height:130%">44</div><div style="line-height:130%">45</div><div style="line-height:130%">46</div><div style="line-height:130%">47</div><div style="line-height:130%">48</div><div style="line-height:130%">49</div><div style="line-height:130%">50</div><div style="line-height:130%">51</div><div style="line-height:130%">52</div><div style="line-height:130%">53</div><div style="line-height:130%">54</div><div style="line-height:130%">55</div><div style="line-height:130%">56</div><div style="line-height:130%">57</div><div style="line-height:130%">58</div><div style="line-height:130%">59</div><div style="line-height:130%">60</div><div style="line-height:130%">61</div><div style="line-height:130%">62</div><div style="line-height:130%">63</div><div style="line-height:130%">64</div><div style="line-height:130%">65</div><div style="line-height:130%">66</div><div style="line-height:130%">67</div><div style="line-height:130%">68</div><div style="line-height:130%">69</div><div style="line-height:130%">70</div><div style="line-height:130%">71</div><div style="line-height:130%">72</div><div style="line-height:130%">73</div><div style="line-height:130%">74</div><div style="line-height:130%">75</div><div style="line-height:130%">76</div><div style="line-height:130%">77</div><div style="line-height:130%">78</div><div style="line-height:130%">79</div><div style="line-height:130%">80</div><div style="line-height:130%">81</div><div style="line-height:130%">82</div><div style="line-height:130%">83</div><div style="line-height:130%">84</div><div style="line-height:130%">85</div><div style="line-height:130%">86</div><div style="line-height:130%">87</div><div style="line-height:130%">88</div><div style="line-height:130%">89</div><div style="line-height:130%">90</div><div style="line-height:130%">91</div><div style="line-height:130%">92</div><div style="line-height:130%">93</div><div style="line-height:130%">94</div><div style="line-height:130%">95</div><div style="line-height:130%">96</div><div style="line-height:130%">97</div><div style="line-height:130%">98</div><div style="line-height:130%">99</div><div style="line-height:130%">100</div><div style="line-height:130%">101</div><div style="line-height:130%">102</div><div style="line-height:130%">103</div><div style="line-height:130%">104</div><div style="line-height:130%">105</div><div style="line-height:130%">106</div><div style="line-height:130%">107</div><div style="line-height:130%">108</div><div style="line-height:130%">109</div><div style="line-height:130%">110</div><div style="line-height:130%">111</div><div style="line-height:130%">112</div><div style="line-height:130%">113</div><div style="line-height:130%">114</div><div style="line-height:130%">115</div><div style="line-height:130%">116</div><div style="line-height:130%">117</div><div style="line-height:130%">118</div><div style="line-height:130%">119</div><div style="line-height:130%">120</div><div style="line-height:130%">121</div><div style="line-height:130%">122</div><div style="line-height:130%">123</div><div style="line-height:130%">124</div><div style="line-height:130%">125</div><div style="line-height:130%">126</div><div style="line-height:130%">127</div><div style="line-height:130%">128</div><div style="line-height:130%">129</div><div style="line-height:130%">130</div><div style="line-height:130%">131</div><div style="line-height:130%">132</div><div style="line-height:130%">133</div><div style="line-height:130%">134</div><div style="line-height:130%">135</div><div style="line-height:130%">136</div><div style="line-height:130%">137</div><div style="line-height:130%">138</div><div style="line-height:130%">139</div><div style="line-height:130%">140</div><div style="line-height:130%">141</div><div style="line-height:130%">142</div><div style="line-height:130%">143</div><div style="line-height:130%">144</div><div style="line-height:130%">145</div><div style="line-height:130%">146</div><div style="line-height:130%">147</div><div style="line-height:130%">148</div><div style="line-height:130%">149</div><div style="line-height:130%">150</div><div style="line-height:130%">151</div><div style="line-height:130%">152</div><div style="line-height:130%">153</div><div style="line-height:130%">154</div><div style="line-height:130%">155</div><div style="line-height:130%">156</div><div style="line-height:130%">157</div><div style="line-height:130%">158</div><div style="line-height:130%">159</div><div style="line-height:130%">160</div><div style="line-height:130%">161</div><div style="line-height:130%">162</div><div style="line-height:130%">163</div><div style="line-height:130%">164</div><div style="line-height:130%">165</div><div style="line-height:130%">166</div><div style="line-height:130%">167</div><div style="line-height:130%">168</div><div style="line-height:130%">169</div><div style="line-height:130%">170</div><div style="line-height:130%">171</div><div style="line-height:130%">172</div><div style="line-height:130%">173</div><div style="line-height:130%">174</div><div style="line-height:130%">175</div><div style="line-height:130%">176</div><div style="line-height:130%">177</div><div style="line-height:130%">178</div><div style="line-height:130%">179</div><div style="line-height:130%">180</div><div style="line-height:130%">181</div><div style="line-height:130%">182</div><div style="line-height:130%">183</div><div style="line-height:130%">184</div><div style="line-height:130%">185</div><div style="line-height:130%">186</div><div style="line-height:130%">187</div><div style="line-height:130%">188</div><div style="line-height:130%">189</div><div style="line-height:130%">190</div><div style="line-height:130%">191</div><div style="line-height:130%">192</div><div style="line-height:130%">193</div><div style="line-height:130%">194</div><div style="line-height:130%">195</div><div style="line-height:130%">196</div><div style="line-height:130%">197</div><div style="line-height:130%">198</div><div style="line-height:130%">199</div><div style="line-height:130%">200</div><div style="line-height:130%">201</div><div style="line-height:130%">202</div><div style="line-height:130%">203</div><div style="line-height:130%">204</div><div style="line-height:130%">205</div><div style="line-height:130%">206</div><div style="line-height:130%">207</div><div style="line-height:130%">208</div><div style="line-height:130%">209</div><div style="line-height:130%">210</div><div style="line-height:130%">211</div><div style="line-height:130%">212</div><div style="line-height:130%">213</div><div style="line-height:130%">214</div><div style="line-height:130%">215</div><div style="line-height:130%">216</div><div style="line-height:130%">217</div><div style="line-height:130%">218</div><div style="line-height:130%">219</div><div style="line-height:130%">220</div><div style="line-height:130%">221</div><div style="line-height:130%">222</div><div style="line-height:130%">223</div><div style="line-height:130%">224</div><div style="line-height:130%">225</div><div style="line-height:130%">226</div><div style="line-height:130%">227</div><div style="line-height:130%">228</div><div style="line-height:130%">229</div><div style="line-height:130%">230</div><div style="line-height:130%">231</div><div style="line-height:130%">232</div><div style="line-height:130%">233</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;구글&nbsp;드라이브와&nbsp;코랩을&nbsp;연동합니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">from</span>&nbsp;google.colab&nbsp;<span style="color:#ff3399">import</span>&nbsp;drive</div><div style="padding:0 6px; white-space:pre; line-height:130%">drive.mount(<span style="color:#ffd500">'/content/drive'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;필요한&nbsp;라이브러리를&nbsp;입력합니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">import</span>&nbsp;numpy&nbsp;as&nbsp;np</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">from</span>&nbsp;math&nbsp;<span style="color:#ff3399">import</span>&nbsp;sqrt</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">from</span>&nbsp;sklearn.metrics&nbsp;<span style="color:#ff3399">import</span>&nbsp;mean_squared_error</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">import</span>&nbsp;pandas&nbsp;as&nbsp;pd</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;존스홉킨스대학&nbsp;CSSE&nbsp;github&nbsp;repository에서&nbsp;매일&nbsp;업데이트&nbsp;되는&nbsp;데이터를&nbsp;가져옵니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;https://github.com/CSSEGISandData/COVID-19</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;confirmed&nbsp;cases&nbsp;/&nbsp;확진자&nbsp;dataframe</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">url&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">confirmed&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;pd.read_csv(url,&nbsp;error_bad_lines<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>False)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;deceased&nbsp;cases&nbsp;/&nbsp;사망자&nbsp;dataframe</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">url&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">death&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;pd.read_csv(url,&nbsp;error_bad_lines<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>False)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;recovered&nbsp;cases&nbsp;/&nbsp;완치자&nbsp;dataframe</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">url&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">recover&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;pd.read_csv(url,&nbsp;error_bad_lines<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>False)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;가장&nbsp;마지막&nbsp;일자를&nbsp;확인&nbsp;합니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">confirmed.columns[<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>:]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;인구&nbsp;데이터를&nbsp;불러옵니다.&nbsp;중국&nbsp;인구&nbsp;데이터는&nbsp;성(省)으로&nbsp;분류되어&nbsp;있으며,&nbsp;나머지&nbsp;인구데이터는&nbsp;국가&nbsp;별로&nbsp;분류되어&nbsp;있습니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">population<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pd.read_csv(<span style="color:#ffd500">'https://raw.githubusercontent.com/Rank23/COVID19/master/population.csv'</span>,&nbsp;sep<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">','</span>,&nbsp;encoding<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'latin1'</span>)&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">population.head()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">confirmed<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pd.merge(confirmed,&nbsp;population,how<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'left'</span>&nbsp;,on<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>[<span style="color:#ffd500">'Province/State'</span>,<span style="color:#ffd500">'Country/Region'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">death<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pd.merge(death,&nbsp;population,how<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'left'</span>&nbsp;,on<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>[<span style="color:#ffd500">'Province/State'</span>,<span style="color:#ffd500">'Country/Region'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">recover<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pd.merge(recover,&nbsp;population,how<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'left'</span>&nbsp;,on<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>[<span style="color:#ffd500">'Province/State'</span>,<span style="color:#ffd500">'Country/Region'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">confirmed.head()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;인구데이터&nbsp;dataframe과&nbsp;확진자&nbsp;데이터&nbsp;dataframe을&nbsp;결합합니다</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">confirmed[<span style="color:#ffd500">'region'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>confirmed[<span style="color:#ffd500">'Country/Region'</span>].map(<span style="color:#4be6fa">str</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#ffd500">'_'</span><span style="color:#0086b3"></span><span style="color:#ff3399">+</span>confirmed[<span style="color:#ffd500">'Province/State'</span>].map(<span style="color:#4be6fa">str</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">death[<span style="color:#ffd500">'region'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>death[<span style="color:#ffd500">'Country/Region'</span>].map(<span style="color:#4be6fa">str</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#ffd500">'_'</span><span style="color:#0086b3"></span><span style="color:#ff3399">+</span>death[<span style="color:#ffd500">'Province/State'</span>].map(<span style="color:#4be6fa">str</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">recover[<span style="color:#ffd500">'region'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>recover[<span style="color:#ffd500">'Country/Region'</span>].map(<span style="color:#4be6fa">str</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#ffd500">'_'</span><span style="color:#0086b3"></span><span style="color:#ff3399">+</span>recover[<span style="color:#ffd500">'Province/State'</span>].map(<span style="color:#4be6fa">str</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">confirmed.iloc[:<span style="color:#c10aff">5</span>,:]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_korea&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;confirmed[confirmed[<span style="color:#ffd500">'Country/Region'</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'Korea,&nbsp;South'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">df_korea_rec&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;recover[recover[<span style="color:#ffd500">'Country/Region'</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'Korea,&nbsp;South'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;감염이&nbsp;보고된&nbsp;모든&nbsp;지역들의&nbsp;시계열&nbsp;dataframe을&nbsp;함수로&nbsp;제작합니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">def</span>&nbsp;create_ts(df):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;ts<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>df</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;ts<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts.drop([<span style="color:#ffd500">'Province/State'</span>,&nbsp;<span style="color:#ffd500">'Country/Region'</span>,<span style="color:#ffd500">'Lat'</span>,&nbsp;<span style="color:#ffd500">'Long'</span>,<span style="color:#ffd500">'&nbsp;Population&nbsp;'</span>],&nbsp;axis<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;ts.set_index(<span style="color:#ffd500">'region'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;ts<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts.T</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;ts.columns<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts.loc[<span style="color:#ffd500">'region'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;ts<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts.drop(<span style="color:#ffd500">'region'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;ts<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts.fillna(<span style="color:#c10aff">0</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;ts<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts.reindex(sorted(ts.columns),&nbsp;axis<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;(ts)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;confirmed&nbsp;case&nbsp;/&nbsp;확진된&nbsp;케이스&nbsp;dataframe</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">ts<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>create_ts(confirmed)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;deceased&nbsp;case&nbsp;/&nbsp;사망한&nbsp;케이스&nbsp;dataframe</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">ts_d<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>create_ts(death)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;recovered&nbsp;case&nbsp;/&nbsp;&nbsp;완치된&nbsp;케이스&nbsp;dataframe</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">ts_rec<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>create_ts(recover)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;R&nbsp;코드에&nbsp;입력할&nbsp;데이터를&nbsp;CSV파일로&nbsp;저장할&nbsp;준비를&nbsp;합니다</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">ts_r<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts.reset_index()</div><div style="padding:0 6px; white-space:pre; line-height:130%">ts_r<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts_r.rename(columns&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{<span style="color:#ffd500">'index'</span>:<span style="color:#ffd500">'date'</span>})</div><div style="padding:0 6px; white-space:pre; line-height:130%">ts_r[<span style="color:#ffd500">'date'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pd.to_datetime(ts_r[<span style="color:#ffd500">'date'</span>]&nbsp;,errors&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'coerce'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">project_path_py&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>r<span style="color:#ffd500">'/content/drive/My&nbsp;Drive/COVID19/COVID19/ts_r.csv'</span>&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">ts_r.to_csv(project_path_py)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;파이썬&nbsp;R&nbsp;라이브러리를&nbsp;불러옵니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">import</span>&nbsp;rpy2</div><div style="padding:0 6px; white-space:pre; line-height:130%">%load_ext&nbsp;rpy2.ipython</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">%%R</div><div style="padding:0 6px; white-space:pre; line-height:130%">install.packages(<span style="color:#ffd500">'pracma'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">install.packages(<span style="color:#ffd500">'reshape'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">%%R</div><div style="padding:0 6px; white-space:pre; line-height:130%">project_path_R&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">'/content/drive/My&nbsp;Drive/COVID19/COVID19/ts_r.csv'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">%%R</div><div style="padding:0 6px; white-space:pre; line-height:130%">require(pracma)</div><div style="padding:0 6px; white-space:pre; line-height:130%">require(Metrics)</div><div style="padding:0 6px; white-space:pre; line-height:130%">require(readr)</div><div style="padding:0 6px; white-space:pre; line-height:130%">all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;read_csv(project_path_R)</div><div style="padding:0 6px; white-space:pre; line-height:130%">all$X1<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">date<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>all[,<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">date[nrow(date)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;<span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>all[nrow(all),<span style="color:#c10aff">1</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">pred_all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;(n&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">2</span>:ncol(all)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;Y<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>ts(data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;all[n<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>],&nbsp;start&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">1</span>,&nbsp;end&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>nrow(all)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>)&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;sig_w<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;w<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>sig_w<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>randn(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">100</span>)&nbsp;<span style="color:#999999">#&nbsp;acceleration&nbsp;which&nbsp;denotes&nbsp;the&nbsp;fluctuation&nbsp;(Q/R)&nbsp;rnorm(100,&nbsp;mean&nbsp;=&nbsp;0,&nbsp;sd&nbsp;=&nbsp;1)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;sig_v<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;v<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>sig_v<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>randn(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">100</span>)&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;t<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">45</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;phi<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">0</span>,t,<span style="color:#c10aff">1</span>),<span style="color:#c10aff">2</span>,<span style="color:#c10aff">2</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;gama<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">0.</span><span style="color:#c10aff">5</span><span style="color:#ff3399">*</span>t^<span style="color:#c10aff">2</span>,t),<span style="color:#c10aff">2</span>,<span style="color:#c10aff">1</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;H<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">0</span>),<span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#999999">#Kalman</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;x0_0<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>p0_0<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">0</span>,<span style="color:#c10aff">0</span>),<span style="color:#c10aff">2</span>,<span style="color:#c10aff">1</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;p0_0<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">0</span>,<span style="color:#c10aff">0</span>,<span style="color:#c10aff">1</span>),<span style="color:#c10aff">2</span>,<span style="color:#c10aff">2</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;Q<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;R<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;X<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;X2<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">0</span>:nrow(all))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;namp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;assign(namp,&nbsp;phi%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%(get(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%t(phi)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>gama%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%Q%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%t(gama))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;namk&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"k"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;assign(namk,get(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%t(H)%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%(<span style="color:#c10aff">1</span><span style="color:#ff3399">/</span>(H%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%t(H)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>R)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;namx&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;assign(namx,phi%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;namE&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"E"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;assign(namE,Y[i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>H%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;namx2&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;assign(namx2,get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>get(paste(<span style="color:#ffd500">"k"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"E"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;namp2&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;assign(namp2,(p0_0<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>get(paste(<span style="color:#ffd500">"k"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%H)%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;X<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(X,get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))[<span style="color:#c10aff">1</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;X2<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(X2,get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))[<span style="color:#c10aff">2</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">if</span>(i<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span><span style="color:#c10aff">2</span>){</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"k"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"E"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>cbind(Y,X,round(X2,<span style="color:#c10aff">4</span>))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>as.data.frame(pred)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred$region<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>colnames(all[,n<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred$date<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>date$date</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred$actual<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(<span style="color:#c10aff">0</span>,(cbind(pred[<span style="color:#c10aff">2</span>:nrow(pred),<span style="color:#c10aff">1</span>])<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>pred[<span style="color:#c10aff">1</span>:nrow(pred)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">100</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred$predict<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(<span style="color:#c10aff">0</span>,(cbind(pred[<span style="color:#c10aff">2</span>:nrow(pred),<span style="color:#c10aff">2</span>])<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>pred[<span style="color:#c10aff">1</span>:nrow(pred)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">100</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred$pred_rate<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>(pred$X<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>pred$Y<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">100</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred$X2_change<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(<span style="color:#c10aff">0</span>,(cbind(pred[<span style="color:#c10aff">2</span>:nrow(pred),<span style="color:#c10aff">3</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>pred[<span style="color:#c10aff">1</span>:nrow(pred)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">3</span>])))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred_all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(pred_all,pred)</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">pred_all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>cbind(pred_all[,<span style="color:#c10aff">4</span>:<span style="color:#c10aff">5</span>],pred_all[,<span style="color:#c10aff">1</span>:<span style="color:#c10aff">3</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">names(pred_all)[<span style="color:#c10aff">5</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#ffd500">"X2"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">pred_all<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pred_all[with(&nbsp;pred_all,&nbsp;order(region,&nbsp;date)),&nbsp;]</div><div style="padding:0 6px; white-space:pre; line-height:130%">pred_all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>pred_all[,<span style="color:#c10aff">3</span>:<span style="color:#c10aff">5</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">q<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>%R&nbsp;pred_all</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts_d</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.stack().reset_index(name<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'confirmed'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">t.columns<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>[<span style="color:#ffd500">'date'</span>,&nbsp;<span style="color:#ffd500">'region'</span>,<span style="color:#ffd500">'confirmed'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">t[<span style="color:#ffd500">'date'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pd.to_datetime(t[<span style="color:#ffd500">'date'</span>]&nbsp;,errors&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'coerce'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.sort_values([<span style="color:#ffd500">'region'</span>,&nbsp;<span style="color:#ffd500">'date'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.iloc[:,:<span style="color:#c10aff">3</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>temp.reset_index(drop<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>True)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#4be6fa">range</span>(<span style="color:#c10aff">1</span>,<span style="color:#4be6fa">len</span>(t)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">if</span>(temp.iloc[i,<span style="color:#c10aff">1</span>]&nbsp;<span style="color:#ff3399">is</span>&nbsp;<span style="color:#ff3399">not</span>&nbsp;temp.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>]):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;temp.loc[<span style="color:#4be6fa">len</span>(temp)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;[temp.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">0</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;pd.DateOffset(<span style="color:#c10aff">1</span>),temp.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>],&nbsp;<span style="color:#c10aff">0</span>]&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>temp.sort_values([<span style="color:#ffd500">'region'</span>,&nbsp;<span style="color:#ffd500">'date'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>temp.reset_index(drop<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>True)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp[<span style="color:#ffd500">'Y'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>q[<span style="color:#ffd500">'Y'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp[<span style="color:#ffd500">'X'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>q[<span style="color:#ffd500">'X'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp[<span style="color:#ffd500">'X2'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>q[<span style="color:#ffd500">'X2'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>ts</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.stack().reset_index(name<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'confirmed'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">t.columns<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>[<span style="color:#ffd500">'date'</span>,&nbsp;<span style="color:#ffd500">'region'</span>,<span style="color:#ffd500">'confirmed'</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">t[<span style="color:#ffd500">'date'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pd.to_datetime(t[<span style="color:#ffd500">'date'</span>]&nbsp;,errors&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'coerce'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.sort_values([<span style="color:#ffd500">'region'</span>,&nbsp;<span style="color:#ffd500">'date'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Add&nbsp;1&nbsp;Future&nbsp;day&nbsp;for&nbsp;prediction</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;예측을&nbsp;위해서&nbsp;하루를&nbsp;dataframe에&nbsp;추가합니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.reset_index(drop<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>True)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#4be6fa">range</span>(<span style="color:#c10aff">1</span>,<span style="color:#4be6fa">len</span>(t)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">if</span>(t.iloc[i,<span style="color:#c10aff">1</span>]&nbsp;<span style="color:#ff3399">is</span>&nbsp;<span style="color:#ff3399">not</span>&nbsp;t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>]):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;t.loc[<span style="color:#4be6fa">len</span>(t)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;[t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">0</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;pd.DateOffset(<span style="color:#c10aff">1</span>),t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>],&nbsp;<span style="color:#c10aff">0</span>]&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.sort_values([<span style="color:#ffd500">'region'</span>,&nbsp;<span style="color:#ffd500">'date'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.reset_index(drop<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>True)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">t[<span style="color:#ffd500">'1_day_change'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t[<span style="color:#ffd500">'3_day_change'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t[<span style="color:#ffd500">'7_day_change'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t[<span style="color:#ffd500">'1_day_change_rate'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t[<span style="color:#ffd500">'3_day_change_rate'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t[<span style="color:#ffd500">'7_day_change_rate'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t[<span style="color:#ffd500">'last_day'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#4be6fa">range</span>(<span style="color:#c10aff">1</span>,<span style="color:#4be6fa">len</span>(t)):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">if</span>(t.iloc[i,<span style="color:#c10aff">1</span>]&nbsp;<span style="color:#ff3399">is</span>&nbsp;t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,<span style="color:#c10aff">1</span>]):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;t.iloc[i,<span style="color:#c10aff">3</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,<span style="color:#c10aff">2</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;t.iloc[i,<span style="color:#c10aff">6</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">100</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;t.iloc[i,<span style="color:#c10aff">9</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">if</span>(t.iloc[i,<span style="color:#c10aff">1</span>]&nbsp;<span style="color:#ff3399">is</span>&nbsp;t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">4</span>,<span style="color:#c10aff">1</span>]):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;t.iloc[i,<span style="color:#c10aff">4</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">4</span>,<span style="color:#c10aff">2</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;t.iloc[i,<span style="color:#c10aff">7</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">4</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">100</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">if</span>(t.iloc[i,<span style="color:#c10aff">1</span>]&nbsp;<span style="color:#ff3399">is</span>&nbsp;t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">8</span>,<span style="color:#c10aff">1</span>]):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;t.iloc[i,<span style="color:#c10aff">5</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">8</span>,<span style="color:#c10aff">2</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;t.iloc[i,<span style="color:#c10aff">8</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">8</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">100</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.fillna(<span style="color:#c10aff">0</span>)&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.merge(temp[[<span style="color:#ffd500">'date'</span>,<span style="color:#ffd500">'region'</span>,&nbsp;<span style="color:#ffd500">'X'</span>]],how<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'left'</span>,on<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>[<span style="color:#ffd500">'date'</span>,<span style="color:#ffd500">'region'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.rename(columns&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{<span style="color:#ffd500">'X'</span>:<span style="color:#ffd500">'kalman_prediction'</span>})&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">t<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.replace([np.inf,&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>np.inf],&nbsp;<span style="color:#c10aff">0</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">t[<span style="color:#ffd500">'kalman_prediction'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>round(t[<span style="color:#ffd500">'kalman_prediction'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">train<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t.merge(confirmed[[<span style="color:#ffd500">'region'</span>,<span style="color:#ffd500">'&nbsp;Population&nbsp;'</span>]],how<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'left'</span>,on<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'region'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">train<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>train.rename(columns&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{<span style="color:#ffd500">'&nbsp;Population&nbsp;'</span>:<span style="color:#ffd500">'population'</span>})</div><div style="padding:0 6px; white-space:pre; line-height:130%">train[<span style="color:#ffd500">'population'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>train[<span style="color:#ffd500">'population'</span>].<span style="color:#4be6fa">str</span>.replace(r<span style="color:#ffd500">"&nbsp;"</span>,&nbsp;<span style="color:#ffd500">''</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">train[<span style="color:#ffd500">'population'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>train[<span style="color:#ffd500">'population'</span>].<span style="color:#4be6fa">str</span>.replace(r<span style="color:#ffd500">","</span>,&nbsp;<span style="color:#ffd500">''</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">train[<span style="color:#ffd500">'population'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>train[<span style="color:#ffd500">'population'</span>].fillna(<span style="color:#c10aff">1</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">train[<span style="color:#ffd500">'population'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>train[<span style="color:#ffd500">'population'</span>].astype(<span style="color:#ffd500">'int32'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">train[<span style="color:#ffd500">'infected_rate'</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>train[<span style="color:#ffd500">'last_day'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>train[<span style="color:#ffd500">'population'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">10000</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">train<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>train.merge(w,how<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'left'</span>,on<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>[<span style="color:#ffd500">'date'</span>,<span style="color:#ffd500">'region'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">train<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>train.sort_values([<span style="color:#ffd500">'region'</span>,&nbsp;<span style="color:#ffd500">'date'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">region<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'Korea,&nbsp;South_nan'</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">evaluation<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pd.DataFrame(columns<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>[<span style="color:#ffd500">'region'</span>,<span style="color:#ffd500">'mse'</span>,<span style="color:#ffd500">'rmse'</span>,<span style="color:#ffd500">'mae'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">place<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#4be6fa">range</span>(<span style="color:#c10aff">1</span>,<span style="color:#4be6fa">len</span>(t)):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">if</span>(t.iloc[i,<span style="color:#c10aff">1</span>]&nbsp;<span style="color:#ff3399">is</span>&nbsp;<span style="color:#ff3399">not</span>&nbsp;t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>]):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;ex<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>np.array(t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#4be6fa">len</span>(ts):i,<span style="color:#c10aff">10</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#&nbsp;print(ex)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>np.array(t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#4be6fa">len</span>(ts):i,<span style="color:#c10aff">2</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#&nbsp;print(pred)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;evaluation<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>evaluation.append({<span style="color:#ffd500">'region'</span>:&nbsp;t.iloc[i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>],&nbsp;<span style="color:#ffd500">'mse'</span>:&nbsp;np.power((ex&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;pred),<span style="color:#c10aff">2</span>).mean(),<span style="color:#ffd500">'rmse'</span>:sqrt(mean_squared_error(ex,pred)),<span style="color:#ffd500">'mae'</span>:&nbsp;(abs(ex&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;pred)).mean()},&nbsp;ignore_index<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>True)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#&nbsp;print(evaluation)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>t[t[<span style="color:#ffd500">'region'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>region][[<span style="color:#ffd500">'date'</span>,<span style="color:#ffd500">'region'</span>,<span style="color:#ffd500">'confirmed'</span>,<span style="color:#ffd500">'kalman_prediction'</span>]]</div><div style="padding:0 6px; white-space:pre; line-height:130%">p.iloc[<span style="color:#4be6fa">len</span>(p)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>None</div><div style="padding:0 6px; white-space:pre; line-height:130%">p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>p.set_index([<span style="color:#ffd500">'date'</span>])</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
          <br>
          <p style="text-align:justify">
            앞서 한 방법 그대로 하루가 아닌 30일 혹은 자신이 원하는 기간 동안의 확진자 수를 숫자를 바꿔 확인할 수 있습니다.
          </p>
          <div class="colorscripter-code" style="color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div><div style="line-height:130%">33</div><div style="line-height:130%">34</div><div style="line-height:130%">35</div><div style="line-height:130%">36</div><div style="line-height:130%">37</div><div style="line-height:130%">38</div><div style="line-height:130%">39</div><div style="line-height:130%">40</div><div style="line-height:130%">41</div><div style="line-height:130%">42</div><div style="line-height:130%">43</div><div style="line-height:130%">44</div><div style="line-height:130%">45</div><div style="line-height:130%">46</div><div style="line-height:130%">47</div><div style="line-height:130%">48</div><div style="line-height:130%">49</div><div style="line-height:130%">50</div><div style="line-height:130%">51</div><div style="line-height:130%">52</div><div style="line-height:130%">53</div><div style="line-height:130%">54</div><div style="line-height:130%">55</div><div style="line-height:130%">56</div><div style="line-height:130%">57</div><div style="line-height:130%">58</div><div style="line-height:130%">59</div><div style="line-height:130%">60</div><div style="line-height:130%">61</div><div style="line-height:130%">62</div><div style="line-height:130%">63</div><div style="line-height:130%">64</div><div style="line-height:130%">65</div><div style="line-height:130%">66</div><div style="line-height:130%">67</div><div style="line-height:130%">68</div><div style="line-height:130%">69</div><div style="line-height:130%">70</div><div style="line-height:130%">71</div><div style="line-height:130%">72</div><div style="line-height:130%">73</div><div style="line-height:130%">74</div><div style="line-height:130%">75</div><div style="line-height:130%">76</div><div style="line-height:130%">77</div><div style="line-height:130%">78</div><div style="line-height:130%">79</div><div style="line-height:130%">80</div><div style="line-height:130%">81</div><div style="line-height:130%">82</div><div style="line-height:130%">83</div><div style="line-height:130%">84</div><div style="line-height:130%">85</div><div style="line-height:130%">86</div><div style="line-height:130%">87</div><div style="line-height:130%">88</div><div style="line-height:130%">89</div><div style="line-height:130%">90</div><div style="line-height:130%">91</div><div style="line-height:130%">92</div><div style="line-height:130%">93</div><div style="line-height:130%">94</div><div style="line-height:130%">95</div><div style="line-height:130%">96</div><div style="line-height:130%">97</div><div style="line-height:130%">98</div><div style="line-height:130%">99</div><div style="line-height:130%">100</div><div style="line-height:130%">101</div><div style="line-height:130%">102</div><div style="line-height:130%">103</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">%%R</div><div style="padding:0 6px; white-space:pre; line-height:130%">install.packages(<span style="color:#ffd500">'reshape'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">%%R</div><div style="padding:0 6px; white-space:pre; line-height:130%">require(pracma)</div><div style="padding:0 6px; white-space:pre; line-height:130%">require(Metrics)</div><div style="padding:0 6px; white-space:pre; line-height:130%">require(readr)</div><div style="padding:0 6px; white-space:pre; line-height:130%">library(reshape)</div><div style="padding:0 6px; white-space:pre; line-height:130%">all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;read_csv(<span style="color:#ffd500">"/content/drive/My&nbsp;Drive/COVID19/COVID19/ts_r.csv"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">all$X1<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">1</span>:<span style="color:#c10aff">30</span>)&nbsp;{&nbsp;<span style="color:#999999">#&nbsp;Set&nbsp;i&nbsp;days&nbsp;prediction</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">if</span>(&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span><span style="color:#c10aff">1</span>)&nbsp;{all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>all_new}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;date<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>all[,<span style="color:#c10aff">1</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;date[nrow(date)&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;<span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>all[nrow(all),<span style="color:#c10aff">1</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred_all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;(n&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">2</span>:ncol(all)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;Y<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>ts(data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;all[n<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>],&nbsp;start&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">1</span>,&nbsp;end&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>nrow(all)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>)&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;sig_w<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;w<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>sig_w<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>randn(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">100</span>)&nbsp;<span style="color:#999999">#&nbsp;acceleration&nbsp;which&nbsp;denotes&nbsp;the&nbsp;fluctuation&nbsp;(Q/R)&nbsp;rnorm(100,&nbsp;mean&nbsp;=&nbsp;0,&nbsp;sd&nbsp;=&nbsp;1)</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;sig_v<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;v<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>sig_v<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>randn(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">100</span>)&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;t<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">45</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;phi<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">0</span>,t,<span style="color:#c10aff">1</span>),<span style="color:#c10aff">2</span>,<span style="color:#c10aff">2</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;gama<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">0.</span><span style="color:#c10aff">5</span><span style="color:#ff3399">*</span>t^<span style="color:#c10aff">2</span>,t),<span style="color:#c10aff">2</span>,<span style="color:#c10aff">1</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;H<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">0</span>),<span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#Kalman</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;x0_0<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>p0_0<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">0</span>,<span style="color:#c10aff">0</span>),<span style="color:#c10aff">2</span>,<span style="color:#c10aff">1</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;p0_0<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>matrix(c(<span style="color:#c10aff">1</span>,<span style="color:#c10aff">0</span>,<span style="color:#c10aff">0</span>,<span style="color:#c10aff">1</span>),<span style="color:#c10aff">2</span>,<span style="color:#c10aff">2</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;Q<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;R<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">01</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;X<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;X2<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">0</span>:nrow(all))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namp&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assign(namp,&nbsp;phi%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%(get(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%t(phi)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>gama%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%Q%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%t(gama))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namk&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"k"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assign(namk,get(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%t(H)%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%(<span style="color:#c10aff">1</span><span style="color:#ff3399">/</span>(H%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%t(H)<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>R)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namx&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assign(namx,phi%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namE&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"E"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assign(namE,Y[i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>H%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namx2&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assign(namx2,get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>get(paste(<span style="color:#ffd500">"k"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"E"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;namp2&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>&nbsp;paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assign(namp2,(p0_0<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>get(paste(<span style="color:#ffd500">"k"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%H)%<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>%get(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(X,get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))[<span style="color:#c10aff">1</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X2<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(X2,get(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i,sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>))[<span style="color:#c10aff">2</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">if</span>(i<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span><span style="color:#c10aff">2</span>){</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"k"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"E"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"p"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove(list<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(paste(<span style="color:#ffd500">"x"</span>,&nbsp;i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,<span style="color:#ffd500">"_"</span>,i<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">2</span>,&nbsp;sep&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">""</span>)))}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>NULL</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>cbind(Y,X,round(X2,<span style="color:#c10aff">4</span>))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>as.data.frame(pred)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred$region<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>colnames(all[,n<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred$date<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>date$date</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred$actual<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(<span style="color:#c10aff">0</span>,(cbind(pred[<span style="color:#c10aff">2</span>:nrow(pred),<span style="color:#c10aff">1</span>])<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>pred[<span style="color:#c10aff">1</span>:nrow(pred)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">1</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">100</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred$predict<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(<span style="color:#c10aff">0</span>,(cbind(pred[<span style="color:#c10aff">2</span>:nrow(pred),<span style="color:#c10aff">2</span>])<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>pred[<span style="color:#c10aff">1</span>:nrow(pred)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">2</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">100</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred$pred_rate<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>(pred$X<span style="color:#0086b3"></span><span style="color:#ff3399">/</span>pred$Y<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>)<span style="color:#0086b3"></span><span style="color:#ff3399">*</span><span style="color:#c10aff">100</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred$X2_change<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(<span style="color:#c10aff">0</span>,(cbind(pred[<span style="color:#c10aff">2</span>:nrow(pred),<span style="color:#c10aff">3</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>pred[<span style="color:#c10aff">1</span>:nrow(pred)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,<span style="color:#c10aff">3</span>])))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;pred_all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(pred_all,pred)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred_all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>cbind(pred_all[,<span style="color:#c10aff">4</span>:<span style="color:#c10aff">5</span>],pred_all[,<span style="color:#c10aff">1</span>:<span style="color:#c10aff">3</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;names(pred_all)[<span style="color:#c10aff">5</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#ffd500">"X2"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;pred_all<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>pred_all[,<span style="color:#c10aff">1</span>:<span style="color:#c10aff">5</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">pred_all_today<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pred_all[with(&nbsp;pred_all,&nbsp;order(region,&nbsp;date)),&nbsp;]</div><div style="padding:0 6px; white-space:pre; line-height:130%">all_new<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>all</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#all_new[nrow(all_new),1]&lt;-all_new[nrow(all),1]+1</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">temp<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>with(pred_all_today,&nbsp;pred_all_today[date&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;all[nrow(all),<span style="color:#c10aff">1</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">+</span><span style="color:#c10aff">1</span>,&nbsp;])</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>cbind(temp[,<span style="color:#c10aff">1</span>:<span style="color:#c10aff">2</span>],temp[,<span style="color:#c10aff">4</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp2<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>reshape(temp,&nbsp;direction&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"wide"</span>,&nbsp;idvar&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"date"</span>,&nbsp;timevar&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"region"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">rand_num<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>runif(ncol(temp2)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,&nbsp;<span style="color:#c10aff">0.</span><span style="color:#c10aff">9</span>,&nbsp;<span style="color:#c10aff">1.</span><span style="color:#c10aff">05</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">temp2[,<span style="color:#c10aff">2</span>:ncol(temp2)]<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>temp2[,<span style="color:#c10aff">2</span>:ncol(temp2)]<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>rand_num</div><div style="padding:0 6px; white-space:pre; line-height:130%">colnames(temp2)<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>colnames(all_new)</div><div style="padding:0 6px; white-space:pre; line-height:130%">all_new<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>rbind(all_new,temp2)</div><div style="padding:0 6px; white-space:pre; line-height:130%">all_new[,<span style="color:#c10aff">2</span>:ncol(all_new)]<span style="color:#0086b3"></span><span style="color:#ff3399">&lt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">-</span>round(all_new[,<span style="color:#c10aff">2</span>:ncol(all_new)])</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;(i&nbsp;<span style="color:#ff3399">in</span>&nbsp;<span style="color:#c10aff">2</span>:ncol(all_new))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;all_new[nrow(all_new),i]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>max(all_new[nrow(all_new)<span style="color:#0086b3"></span><span style="color:#ff3399">-</span><span style="color:#c10aff">1</span>,i],all_new[nrow(all_new),i])}</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">all_new<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>%R&nbsp;all_new</div><div style="padding:0 6px; white-space:pre; line-height:130%">all_new[<span style="color:#ffd500">'date'</span>]<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>pd.to_datetime(all_new[<span style="color:#ffd500">'date'</span>],unit<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'d'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;한국의&nbsp;향후&nbsp;30일&nbsp;확진자&nbsp;추이를&nbsp;그래프로&nbsp;표현합니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">region&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;[<span style="color:#ffd500">'date'</span>,&nbsp;<span style="color:#ffd500">"Korea,&nbsp;South_nan"</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">p_kalman<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>all_new[region]</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#p=all_new</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#p.iloc[len(p)-1,2]=None</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">p_kalman<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>p_kalman.set_index([<span style="color:#ffd500">'date'</span>])</div><div style="padding:0 6px; white-space:pre; line-height:130%">p_kalman.iloc[:,:].plot(marker<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'o'</span>,figsize<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(<span style="color:#c10aff">12</span>,<span style="color:#c10aff">5</span>)).set_title(<span style="color:#ffd500">'Kalman&nbsp;Prediction&nbsp;{}'</span>.<span style="color:#4be6fa">format</span>(region[<span style="color:#c10aff">1</span>]),&nbsp;fontdict<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>{<span style="color:#ffd500">'fontsize'</span>:&nbsp;<span style="color:#c10aff">18</span>})</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">prediction_one_month&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;p_kalman.tail(<span style="color:#c10aff">30</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">prediction_one_month.plot(marker<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'o'</span>,figsize<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>(<span style="color:#c10aff">12</span>,<span style="color:#c10aff">5</span>)).set_title(<span style="color:#ffd500">'Kalman&nbsp;Prediction&nbsp;{}'</span>.<span style="color:#4be6fa">format</span>(region[<span style="color:#c10aff">1</span>]),&nbsp;fontdict<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>{<span style="color:#ffd500">'fontsize'</span>:&nbsp;<span style="color:#c10aff">18</span>})</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#예측&nbsp;결과를&nbsp;구글&nbsp;드라이브에&nbsp;csv&nbsp;파일로&nbsp;저장합니다.</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">path&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'/content/drive/My&nbsp;Drive/COVID19/COVID19/cf_predict.csv'</span>&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">prediction_one_month.to_csv(path)</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
        </div>
      </div>
  </body>
</html>
